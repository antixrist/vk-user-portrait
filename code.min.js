(function(){function d(a,b,c,f){var g;g=d.toArray(arguments);var e=g[4]||!1;e||(g=d._parseArgs(g),a=g.timeout,b=g.interval,c=g.condition,f=g.callback);if(!(this instanceof d))return new d(a,b,c,f,!0);this.timeout=a;this.interval=b;this.condition=c;this.callback=f;this.done=!1;this.iteration=this.elapsedTime=0;this.tstart=d.getTimeInMs();this.check()}var q=this;d._parseArgs=function(a){var b={};1==a.length?b=a[0]:(b.timeout=a[0]||!1,b.interval=a[1]||!1,b.condition=a[2]||!1,b.callback=a[3]||!1);a={};
a.timeout=parseInt(b.timeout||1,10)||1;a.interval=parseInt(b.interval||1,10)||1;a.condition="function"==typeof b.condition?b.condition:d.noopPositive;a.callback="function"==typeof b.callback?b.callback:d.noop;return a};d.prototype={constructor:d,check:function(){var a;this.iteration+=1;this.elapsedTime=d.getTimeInMs()-this.tstart;this.done||(this.elapsedTime<=this.timeout?(a=this.condition(this.elapsedTime,this.iteration,this.afterCheck.bind(this)),this.afterCheck(a)):(a=[Error(d.errText),this.elapsedTime,
this.iteration],this.runCallback.apply(this,a)))},afterCheck:function(a){var b=this,c;"undefined"!=typeof a&&(a?(b.done=!0,c=[null,b.elapsedTime,b.iteration],d.isArray(a)&&(c=c.concat(a)),b.runCallback.apply(b,c)):setTimeout(function(){b.check()},b.interval))},runCallback:function(a){"undefined"!=typeof a&&d.isArray(a)||(a=d.toArray(arguments));this.callback.apply(q,a)}};d.errText="[waiter.js] Timeout with false condition";d.noop=function(){};d.noopPositive=function(){return!0};d.getTimeInMs=function(){Date.now||
(Date.now=function(){return(new Date).getTime()});return Date.now()};d.toArray=function(a){return Array.prototype.slice.call(a,0)};d.isArray=function(a){Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});return Array.isArray(a)};waiter=d;"undefined"!=typeof module&&"undefined"!=typeof module.exports&&(module.exports=waiter);var m=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},c=function(){var a=window.jQuery,b=Array.prototype.slice.call(arguments,
0),c=b[0]||"",d=!1,g=!1,e=!1,h="[vk_portrait] ",k="";c&&("boolean"==typeof b[1]||m(b[1])?(d=!!b[1],"boolean"==typeof b[2]||m(b[2])?(g=!!b[2],e=b[3]):e=b[2]):e=b[1],e&&(a.isPlainObject(e)?k="\n"+JSON.stringify(e):a.isArray(e)&&(k="\n"+e.join("\n"))),d&&(h+="[error] "),console.info(h+c+k),e&&console.log(e),g&&alert(h+c+k))};"undefined"==typeof window.jQuery&&function(){window.setTimeout(function(){var a=document,b=a.getElementsByTagName("script")[0],a=a.createElement("script");a.type="text/javascript";
a.async=!0;a.src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js?"+(new Date).getTime();b.parentNode.insertBefore(a,b)},1)}();window.vk_portrait=!0;c("Waiting jQuery...");waiter(1E4,100,function(a,b,c){return"undefined"!=typeof window.jQuery},function(a,b,d){if(a)c("jQuery load failed",!0,!0);else{var f=window.jQuery;c("jQuery loaded!");a=function(a){a=(a||"").match(/(https?:\/\/)?(vk.com)?\/?([^\?]+)/)[3]||"";return a=parseInt(a,10)==a?"id"+a:a};var g=function(a){f(".feed_row").remove();
feed.showMore();waiter(3E4,200,function(){return f(".post").length},function(b){b&&(c("No finded posts!",!0,!0),window.vk_portrait=!1);f.isFunction(a)&&a()})},e=function(){var a=[];f(".post").each(function(b,c){f(c);var d=c.id.match(/post(.+)/)[1];a.push(d)});return a},h=function(a,b){$node=f("#post"+a);window.setTimeout(function(a,b){return function(){f.isFunction(b)&&b(a)}}(a,b),Math.floor(201*Math.random())+100)},k=function(a){return f.isArray(a)?a.map(function(a,b){return"https://vk.com/wall"+
a}):a},m=function(a,b){if(!f.isArray(a))return[];var c=[],d=0;a.forEach(function(e,g){2!=e.split("_").length?d++:h(e,function(e){f.post("https://vk.com/like.php",{act:"a_get_stats",al:1,has_share:1,object:"wall"+e},function(e){return function(g){d++;g&&(g.match(/href[\s]?=[\s]?['"][\s]?\/(.+?)[\s]?['"]/gm).forEach(function(a,b){a.match(/href[\s]?=[\s]?['"][\s]?\/(.+?)[\s]?['"]/)[1]==l&&c.push(e)}),f.isFunction(b)&&d==a.length&&(c=c.length?f.unique(c):c,b(c)))}}(e))})})},n=[],p=function(){window.ajaxCache=
{};var a=e();a.length?m(a,function(a){a.length&&(a=k(a),c("finded:",a,!1,!1),n=n.concat(a));window.vk_portrait?window.setTimeout(function(){g(function(){p()})},Math.floor(201*Math.random())+100):c("Stopped!",n,!1,!0)}):c("Done!",n,!1,!0)};window.vkPortraitResolverCallback=function(a){var b=document.getElementById("vkPortraitResolver");b&&b.remove();if(a&&a.response&&"user"==a.response.type&&a.response.object_id){c("Resolved user's id: "+a.response.object_id);var d="https://vk.com/feed?section=source&source="+
a.response.object_id;a.response.object_id?(c("Try to loading user's feed page..."),nav.go(d,null,{noback:!0}),waiter(5E3,100,function(){return document.location.href==d&&f(".post").length},function(a){a?c("Fail loading feed page!",!0,!0):(c("Feed loaded! Seaching..."),p())})):c("Resolve user's fail!",!0,!0)}};var l=prompt("Enter link","");l?(l=a(l),c("User's screen name: \""+l+'"'),a=document.createElement("script"),a.id="vkPortraitResolver",a.src="https://api.vk.com/method/utils.resolveScreenName?screen_name="+
l+"&v=5.35&callback=vkPortraitResolverCallback",a.onerror=function(){c("Resolve user's fail!",!0,!0)},c("Try to resolve user's id..."),document.getElementsByTagName("head")[0].appendChild(a)):c("Link required",1,1)}})})();
